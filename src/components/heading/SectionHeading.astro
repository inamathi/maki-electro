---
// src/components/SectionHeader.astro
const { headingEn = "", headingJa, headingSub } = Astro.props;
const enChars = Array.from(headingEn);
---

<section class="section-header" data-en={headingEn}>
  <!-- 背景：英字を1文字ずつ -->
  <div class="bg" aria-hidden="true">
    <div class="bg-line">
      {
        enChars.map((ch, i) => (
          <span class="ch" style={`--i:${i}`}>
            {ch === " " ? "\u00A0" : ch}
          </span>
        ))
      }
    </div>
  </div>
  <div class="section-header__ja">
    <div class="section-header__sub">{headingSub}</div>
    <h2 class="section-header__main">{headingJa}</h2>
    <div class="section-header__underline"></div>
  </div>
</section>

<style lang="scss">
  @use "../../styles/var" as var;
  .section-header {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 40px 0 0;
    width: 100%;
    max-width: 1920px;
    margin: auto;

    &__ja {
      position: relative;
      display: grid;
      place-items: center;
      color: #fff;
      gap: 10px;
      margin: auto;
    }
    &__sub {
      font-size: 0.875rem;
      opacity: 0.8;
      margin-bottom: 0.25rem;
      z-index: 1;
    }

    &__main {
      font-size: 1.5rem;
      font-weight: bold;
      margin: 0;
      z-index: 1;
    }

    &__underline {
      margin-top: 0.25rem;
      height: 3px;
      width: 80px;
      background-color: #3cff5e;
      z-index: 1;
    }

    &__blank {
      flex: 1;
    }
  }
  /* 背景テキスト */
  .bg {
    position: absolute;
    inset: 0;
    transform: translateY(-30px);
    display: grid;
    place-items: center;
    pointer-events: none;
    user-select: none;
    z-index: 0;
  }
  .bg-line {
    font-weight: 800;
    font-size: clamp(24px, 12vw, 64px);
    line-height: 1;
    color: rgba(255, 255, 255, 0.06);
    letter-spacing: 0px;
    white-space: pre; /* 空白保持 */
  }
  .ch {
    display: inline-block;
    opacity: 0;
    transform: translateY(0.25em);
    animation: fadeUp 0.6s ease forwards;
    /* 文字ごとに遅延（--staggerを変えれば速度調整） */
    animation-delay: calc(var(--i) * var(--stagger, 60ms));
  }
  @keyframes fadeUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* 日本語側を前面に */
  .section-header__ja {
    position: relative;
    z-index: 1;
    color: #fff;
    display: grid;
    place-items: center;
    gap: 10px;
  }
  .section-header__sub {
    font-size: 0.875rem;
    opacity: 0.8;
    margin-bottom: 0.25rem;
  }
  .section-header__main {
    font-size: 1.5rem;
    font-weight: 700;
    margin: 0;
  }
  .section-header__underline {
    margin-top: 0.25rem;
    height: 3px;
    width: 80px;
    background: #3cff5e;
  }

  /* 動きを控えたいユーザー配慮 */
  @media (prefers-reduced-motion: reduce) {
    .ch {
      animation: none;
      opacity: 1;
      transform: none;
    }
  }

  @include var.down(lg) {
    .section-header__main {
      font-size: 20px;
    }
    .bg-line {
      font-size: 24px;
    }
  }
</style>
